# üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –ë–î

## –ü—Ä–æ–±–ª–µ–º–∞:

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≥–æ–≤–æ—Ä–∏—Ç "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", —Ö–æ—Ç—è –≤—ã –æ—á–∏—Å—Ç–∏–ª–∏ –ë–î.

**–ü—Ä–∏—á–∏–Ω–∞:** –£ –≤–∞—Å 2 —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:
- `users` - —Å—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞
- `auth_users` - –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–π—á–∞—Å)

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `auth_users`:

**–§–∞–π–ª:** `src/api/auth.controller.ts` (—Å—Ç—Ä–æ–∫–∞ 80-84)

```typescript
const { data: existingUser } = await supabase
  .from('auth_users')  // ‚Üê –ü–†–û–í–ï–†–ö–ê –ó–î–ï–°–¨
  .select('id')
  .eq('email', email)
  .single();
```

---

## üîß –ö–∞–∫ –æ—á–∏—Å—Ç–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É **`auth_users`** (–ù–ï `users`!)
4. –£–¥–∞–ª–∏—Ç–µ –≤—Å–µ –∑–∞–ø–∏—Å–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ SQL Editor

```sql
-- –û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É auth_users
DELETE FROM auth_users;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è
SELECT COUNT(*) FROM auth_users;
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 0
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—á–∏—Å—Ç–∏—Ç—å –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)

```sql
-- –û—á–∏—Å—Ç–∏—Ç—å –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã
DELETE FROM auth_users;
DELETE FROM users;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
SELECT COUNT(*) FROM auth_users;
SELECT COUNT(*) FROM users;
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
```typescript
// auth.controller.ts - —Å—Ç—Ä–æ–∫–∞ 111
const { data, error: insertError } = await supabase
  .from('auth_users')  // ‚Üê –í–°–¢–ê–í–ö–ê –í auth_users
  .insert({...})
```

### –õ–æ–≥–∏–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
```typescript
// auth.controller.ts - —Å—Ç—Ä–æ–∫–∞ 191
const { data, error: userError } = await supabase
  .from('auth_users')  // ‚Üê –ü–û–ò–°–ö –í auth_users
  .select('*')
  .eq('email', email)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ OTP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
```typescript
// auth.controller.ts - —Å—Ç—Ä–æ–∫–∞ 189
const { data, error: userError } = await supabase
  .from('auth_users')  // ‚Üê –ü–û–ò–°–ö –í auth_users
  .select('*')
  .eq('email', email)
  .eq('confirmation_token', otp)
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:

### `auth_users` (–ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø):
```sql
CREATE TABLE auth_users (
  id UUID PRIMARY KEY,
  email TEXT UNIQUE,
  password_hash TEXT,
  full_name TEXT,
  email_confirmed BOOLEAN,
  confirmation_token TEXT,
  otp_expiry TIMESTAMPTZ,  -- ‚Üê –ù–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è OTP
  status TEXT,
  role TEXT,
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
);
```

### `users` (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø):
```sql
-- –°—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
DROP TABLE IF EXISTS users;
```

---

## üß™ –¢–µ—Å—Ç –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:

### 1. –û—á–∏—Å—Ç–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É:
```sql
DELETE FROM auth_users;
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```sql
SELECT * FROM auth_users;
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 0 rows
```

### 3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è:
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173
# –ù–∞–∂–º–∏—Ç–µ "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"
# –í–≤–µ–¥–∏—Ç–µ email: test@example.com
# –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: Test123!@#
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —Å OTP –∫–æ–¥–æ–º
- ‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `/verify-otp`

---

## üîß –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å:

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–µ—à Supabase:

```typescript
// –í auth.controller.ts –¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ email:', email);

const { data: existingUser } = await supabase
  .from('auth_users')
  .select('id')
  .eq('email', email)
  .single();

console.log('üìä –ù–∞–π–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', existingUser);
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
npm run dev
```

---

## üóëÔ∏è –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

```sql
-- 1. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
DELETE FROM auth_users;
DELETE FROM users;

-- 2. –°–±—Ä–æ—Å–∏—Ç—å sequences (–µ—Å–ª–∏ –µ—Å—Ç—å)
ALTER SEQUENCE IF EXISTS auth_users_id_seq RESTART WITH 1;

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
SELECT COUNT(*) FROM auth_users;
SELECT COUNT(*) FROM users;

-- 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
\d auth_users
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç:

- [ ] –û—á–∏—Å—Ç–∏–ª —Ç–∞–±–ª–∏—Ü—É `auth_users`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª —Å–µ—Ä–≤–µ—Ä
- [ ] –ü–æ–ø—Ä–æ–±–æ–≤–∞–ª –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

### –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É `users`:

```sql
-- –ï—Å–ª–∏ –æ–Ω–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
DROP TABLE IF EXISTS users CASCADE;
```

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ `auth_users`:

–≠—Ç–æ –∏–∑–±–∞–≤–∏—Ç –æ—Ç –ø—É—Ç–∞–Ω–∏—Ü—ã –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç –∫–æ–¥.

---

**–û—á–∏—Å—Ç–∏—Ç–µ `auth_users` –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!** üöÄ
