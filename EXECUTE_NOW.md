# üöÄ –í–´–ü–û–õ–ù–ò–¢–¨ –°–ï–ô–ß–ê–° - –ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

## ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª: `migrations/STEP_BY_STEP.sql`

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor**
2. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª** `migrations/STEP_BY_STEP.sql`
3. **–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –±–ª–æ–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É** (–∫–∞–∂–¥—ã–π –±–ª–æ–∫ –æ—Ç–¥–µ–ª—å–Ω–æ!)

---

## üìã –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

### ‚úÖ –®–ê–ì 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã roles
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 1" –∏–∑ —Ñ–∞–π–ª–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–∞–±–ª–∏—Ü–∞ `roles` —Å–æ–∑–¥–∞–Ω–∞

---

### ‚úÖ –®–ê–ì 2: –í—Å—Ç–∞–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö —Ä–æ–ª–µ–π
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 2"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 4 —Ä–æ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã (free, pro, premium, admin)

---

### ‚úÖ –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 3"

**–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:**
```
name    | display_name  | is_subscription
--------|---------------|----------------
free    | Free          | false
pro     | Pro           | true
premium | Premium       | true
admin   | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | false
```

---

### ‚úÖ –®–ê–ì 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ role_id –≤ auth_users
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 4"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–µ `role_id` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `auth_users`

---

### ‚úÖ –®–ê–ì 5: Foreign key –∏ –∏–Ω–¥–µ–∫—Å
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 5"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

---

### ‚úÖ –®–ê–ì 6: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 6"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `role='admin'` ‚Üí –ø–æ–ª—É—á–∞—Ç —Ä–æ–ª—å `admin`
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí –ø–æ–ª—É—á–∞—Ç —Ä–æ–ª—å `free`

---

### ‚úÖ –®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 7"

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Ö –Ω–æ–≤—ã–º–∏ —Ä–æ–ª—è–º–∏:**
```
email                    | old_role | new_role_name | display_name
-------------------------|----------|---------------|---------------
plutoniy2033@gmail.com   | admin    | admin         | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
bespredel.owner@mail.ru  | admin    | admin         | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
codelone0@gmail.com      | admin    | admin         | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
stayalive019@gmail.com   | user     | free          | Free
```

---

### ‚úÖ –®–ê–ì 8: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã subscriptions
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 8"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–∞–±–ª–∏—Ü–∞ `subscriptions` —Å–æ–∑–¥–∞–Ω–∞

---

### ‚úÖ –®–ê–ì 9: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ "–®–ê–ì 9"

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:**
- Roles count: 4
- Users with roles: 4
- Subscriptions count: 0
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—è–º–∏

---

## üéâ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API:
```bash
docker compose restart api
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥–º–∏–Ω–∫—É:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://ebuster.ru/admin
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–æ–ª–∏"
3. –î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –≤—Å–µ 4 —Ä–æ–ª–∏
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–æ–ª—å

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

- –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –±–ª–æ–∫–∏ **—Å—Ç—Ä–æ–≥–æ –ø–æ –ø–æ—Ä—è–¥–∫—É**
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ï—Å–ª–∏ —à–∞–≥ –≤—ã–¥–∞–ª –æ—à–∏–±–∫—É - **–ù–ï –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ**, —Å–æ–æ–±—â–∏—Ç–µ –æ–± –æ—à–∏–±–∫–µ
- –ù–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –≤–µ—Å—å —Ñ–∞–π–ª —Å—Ä–∞–∑—É!

---

## üîß –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

### –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```sql
-- –£–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã (–û–°–¢–û–†–û–ñ–ù–û!)
DROP TABLE IF EXISTS subscriptions;
DROP TABLE IF EXISTS roles CASCADE;

-- –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ role_id –∏–∑ auth_users
ALTER TABLE auth_users DROP COLUMN IF EXISTS role_id;
```

–ó–∞—Ç–µ–º –Ω–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —Å –®–∞–≥–∞ 1.

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö 9 —à–∞–≥–æ–≤:
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ roles —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ 4 –±–∞–∑–æ–≤—ã–µ —Ä–æ–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ —Ä–æ–ª–∏
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ subscriptions —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ API –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –ø–æ–∫–∞–∂–µ—Ç —Ä–æ–ª–∏
